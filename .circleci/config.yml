version: 2.1

orbs:
  windows: circleci/windows@2.2.0

jobs:
  build:
    executor: win/vs2019
    steps:
      - checkout
      - restore_cache:
          keys:
      - run: dotnet restore Datadog.Trace.sln
      - run: dotnet build Datadog.Trace.sln
      save_cache:
        paths:
          - C:\Users\circleci\.nuget\packages

      - run: dotnet test test/Datadog.Trace.Tests.csproj
      - run: dotnet test test/Datadog.Trace.ClrProfiler.Managed.Tests.csproj